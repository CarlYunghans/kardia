$Version=2$
mlist_maint "widget/component-decl"
    {
    width=780;height=580;

    search_box "widget/editbox"
	{
	x=0; y=0; width=228; height=20;
	empty_description = ":i18n:Type search here and press ENTER";

	enter_cn "widget/connector"
	    {
	    event=ReturnPressed;
	    event_condition = runclient(not (charindex(upper(:search_box:content), upper(:tree:selected_label + :tree:selected_name)) > 0));
	    target=tree;
	    action=Search;
	    Value = runclient(:search_box:content);
	    }
	enter_cn_next "widget/connector"
	    {
	    event=ReturnPressed;
	    event_condition = runclient(charindex(upper(:search_box:content), upper(:tree:selected_label + :tree:selected_name)) > 0);
	    target=tree;
	    action=SearchNext;
	    }
	}

    tree_pane "widget/pane"
	{
	x=0;y=28;width=230;height=558;
	style=lowered;
	bgcolor=white;

	tree_scroll "widget/scrollpane"
	    {
	    x=0;y=0;width=228;height=556;

	    tree "widget/treeview"
		{
		x=0;y=0;width=228;
		//height=298;
		source="/apps/kardia/modules/base/mlists.qyt/";
		show_branches=yes;
		show_root=no;
		show_root_branch = yes;
		use_3d_lines=no;
		highlight_bgcolor = "#153f5f";
		highlight_fgcolor = white;

		sync1 "widget/connector"
		    {
		    event = SelectItem;
		    event_condition = runclient(:Label != 'Publications' and :Label != 'Selections');
		    target = mlist_osrc;
		    action = QueryParam;
		    m_list_code = runclient(:Name);
		    }
		}
	    }
	}

    onelist_vbox "widget/vbox"
	{
	x=240; y=0; height=580; width=540;
	spacing=8;

	onelist_section "widget/component"
	    {
	    path = "/apps/kardia/modules/base/section_label.cmp";
	    height=20;
	    text = runclient(isnull('Mailing List: ' + :mlist_osrc:m_list_code + ' - ' + :mlist_osrc:m_list_description, '(none selected)'));
	    }

	mlist_osrc "widget/osrc"
	    {
	    autoquery = never;
	    readahead = 2;
	    replicasize = 2;
	    sql = "select * from /apps/kardia/data/Kardia_DB/m_list/rows";
	    baseobj = "/apps/kardia/data/Kardia_DB/m_list/rows";

	    mlist_form "widget/form"
		{
		f_code "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_code'; ctl_type=editbox; text='List ID:'; label_width=120; }
		f_parent "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_parent'; ctl_type=editbox; text='Related To List:'; label_width=120; }
		//f_parent "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_parent'; ctl_type=dropdown; text='Related To List:'; sql=runserver("select :m_list_code + ': ' + :m_list_description, :m_list_code from /apps/kardia/data/Kardia_DB/m_list/rows order by :m_list_code"); label_width=120; } 
		f_desc "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_description'; ctl_type=editbox; text='Description:'; label_width=120; }
		f_stat "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_status'; ctl_type=dropdown; text='Status:'; sql=runserver("select :text, :tag from /apps/kardia/data/Kardia_DB/_m_list_status/rows order by :text"); label_width=120; } 
		f_type "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_type'; ctl_type=dropdown; text='List Type:'; sql=runserver("select :text, :tag from /apps/kardia/data/Kardia_DB/_m_list_type/rows order by :text"); label_width=120; f_type_hints "widget/hints" { default=runclient(condition(charindex(:tree:selected_name, 'Publications') > 0, 'P', 'S')); } }
		f_frozen "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_list_frozen'; ctl_type=checkbox; text='List Frozen?'; label_width=120; f_frozen_hints "widget/hints" { default=runclient(0); } }
		f_discard "widget/component" { height=20; width=400; path="/sys/cmp/smart_field.cmp"; field='m_discard_after'; ctl_type=datetime; text='Discard After:'; label_width=120; }
		}
	    }
	}
    }
